---
default:
  image:
    tag: latest

opentelemetry-collector:
  image:
    tag: latest
  mode: deployment
  presets:
    logsCollection:
      enabled: true
      includeCollectorLogs: false
  service:
    enabled: true
  config:
    exporters:
      opensearch: null
      otlphttp/prometheus: null
      otlp:
        endpoint: http://tempo-distributor-lgtm-central.tempo.svc:4317
        tls:
          insecure: true # Linkerd uses mTLS behind the scenes
        headers:
          X-Scope-OrgID: remote02
      prometheusremotewrite:
        endpoint: http://mimir-distributor-lgtm-central.mimir.svc:8080/api/v1/push
        tls:
          insecure: true # Linkerd uses mTLS behind the scenes
        headers:
          X-Scope-OrgID: remote02
      loki:
        endpoint: http://loki-write-lgtm-central.loki.svc:3100/loki/api/v1/push
        tls:
          insecure: true # Linkerd uses mTLS behind the scenes
        headers:
          X-Scope-OrgID: remote02
    processors:
      tail_sampling:
        policies:
          [
            {
              name: errors-policy,
              type: status_code,
              status_code: { status_codes: [ERROR] },
            },
            {
              name: randomized-policy,
              type: probabilistic,
              probabilistic: { sampling_percentage: 30 },
            },
          ]
    service:
      pipelines:
        metrics:
          receivers:
          - otlp
          - prometheus
          exporters:
          - prometheusremotewrite
        logs:
          exporters:
          - loki
        traces:
          processors:
          - k8sattributes
          - memory_limiter
          - resource
          - tail_sampling
          - batch
          exporters:
          - otlp

jaeger:
  enabled: false

prometheus:
  enabled: false

grafana:
  enabled: false

opensearch:
  enabled: false

components:
  featureflagService:
    resources:
      limits:
        memory: null
  loadgenerator:
    resources:
      limits:
        memory: null